<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>CDPModule1</title>
    <base href="/" />
    <link href="css/bootstrap/bootstrap.min.css" rel="stylesheet" />
    <link href="css/app.css" rel="stylesheet" />
    <link href="CDPModule1.Client.styles.css" rel="stylesheet" />

</head>

<body>

    <div id="app">Loading...</div>

    <div id="blazor-error-ui">
        An unhandled error has occurred.
        <a href="" class="reload">Reload</a>
        <a class="dismiss">ðŸ—™</a>
    </div>
    <script src="_framework/blazor.webassembly.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <script type="text/javascript">
        //Data
        var data = [{
            "id": 1,
            "title": "iPhone 9",
            "sale": 549

        },
        {
            "id": 2,
            "title": "iPhone XR",
            "sale": 1490

        },
        {
            "id": 3,
            "title": "iPhone 11",
            "sale": 140

        },
        {
            "id": 4,
            "title": "iPhone 11 pro",
            "sale": 812

        }
        ]


        var str = JSON.stringify(data);
        console.log(data);

        const label = [];
        const series = [];

        for (var k in data) {
            label.push(data[k].title);
            series.push(data[k].sale);

        }

        console.log(label);


        //Pie Chart

        var PieOptions = {
            series: series,
            chart: {
                width: 380,
                type: 'pie',
            },
            labels: label,
            responsive: [{
                breakpoint: 480,
                options: {
                    chart: {
                        width: 200
                    },
                    legend: {
                        position: 'bottom'
                    }
                }
            }]
        };

        //var PieChart = new ApexCharts(document.querySelector(".PieChart"), PieOptions);
        //PieChart.render();


        //chart 2

        var BarOptions = {
            series: [{
                data: series
            }],
            chart: {
                type: 'bar',
                height: 380
            },
            plotOptions: {
                bar: {
                    barHeight: '100%',
                    distributed: true,
                    horizontal: true,
                    dataLabels: {
                        position: 'bottom'
                    },
                }
            },
            colors: ['#33b2df', '#546E7A', '#d4526e'],
            dataLabels: {
                enabled: true,
                textAnchor: 'start',
                style: {
                    colors: ['#fff']
                },
                formatter: function (val, opt) {
                    return opt.w.globals.labels[opt.dataPointIndex] + ":  " + val
                },
                offsetX: 0,
                dropShadow: {
                    enabled: true
                }
            },
            stroke: {
                width: 1,
                colors: ['#fff']
            },
            xaxis: {
                categories: label,
            },
            yaxis: {
                labels: {
                    show: false
                }
            },
            title: {
                text: 'Custom DataLabels',
                align: 'center',
                floating: true
            },
            subtitle: {
                text: 'Category Names as DataLabels inside bars',
                align: 'center',
            },
            tooltip: {
                theme: 'dark',
                x: {
                    show: false
                },
                y: {
                    title: {
                        formatter: function () {
                            return ''
                        }
                    }
                }
            }
        };

        //var BarChart = new ApexCharts(document.querySelector(".BarChart"), BarOptions);
        //BarChart.render();


        //function
        function getChart(ChartType) {
            // alert(ChartType);
            //document.getElementById('chartDiv').className = ChartType;

            if (ChartType == "PieChart") {
                var Chart = new ApexCharts(document.querySelector("#chartDiv"), PieOptions);
                Chart.render();
            }

            if (ChartType == "BarChart") {
                var Chart = new ApexCharts(document.querySelector("#chartDiv"), BarOptions);
                Chart.render();
            }

        }



        //data click
        var data = [];
        function getText(current) {


            var text = current.innerHTML;
            //var Xposition = current.getAttribute('x');
            //var Yposition = current.getAttribute('y');
            //var GID = current.parentNode.getAttribute('id');

           

            var d = {
                TemplateName: $('#templateName').val(),
                FieldName: $('#Field').val(),
                ParentIdentifier: current.parentNode.getAttribute('id'),
                XPosition: current.getAttribute('x'),
                Yposition: current.getAttribute('y'),
                Text:text,
                Type: $('#valueType').val(),
            }

            $('#propText').val(text);

            data.push(d);

            console.log(data);


        }

        function insertData() {



            console.log('==> insertdata==>', data);

            $.ajax({
                url: 'api/File/SaveTemplate',
                contentType: 'application/json',
                data: JSON.stringify(data),
                method: 'POST',
                success: function (data) {
                    data = JSON.parse(data);
                }, error: function (error) {
                    console.log(error);
                }
            });

        }




    </script>
</body>

</html>
